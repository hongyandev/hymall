function updateCartGoods(e,o){$.ajax({type:"POST",url:"http://sge.cn:9090/erp/api/updateCartGoods",data:{userid:180129145541,goodsid:e,qty:o},dataType:"json",success:function(e){e.code}})}$(function(){$.ajax({type:"POST",url:"http://sge.cn:9090/erp/api/cartItems",data:{userid:180129145541},dataType:"json",success:function(e){if(200==e.code){var o="";e.data.cartItems&&$.each(e.data.cartItems,function(t,c){o+='<div class="shopGroup"><div class="shopName clear">\n    <input type="checkbox" class="check shopCheck">\n    <h4 class="font14 khmc fle"><a href="#">'+e.data.cartItems[t].khmc+"</a></h4>\n</div>",o+="<ul>",$.each(c.cartItem,function(e,t){o+="<li value='"+t.goodsId+"'>                 <div class='shopCon'>                     <input type='checkbox' class='check goodsCheck' value='"+t.goodsId+'\'>                     <div class="shopImg"><a href="#"><img src=\''+t.imageUrl+'?x-oss-process=image/resize,l_100\' /></a></div>\n                     <div class="shopText">                         <div class="shoptit">                             <h4>'+t.goodsName+'</h4>                             <div class="shopBrief font12">规格：<span>'+t.goodsType+"</div>                             <a class='deletedIcon' href='javascript:void(0)'></a>                         </div>                         <div class=\"shopPrice\">                             <div class=\"shopPices font12\">积分<b class='price font14'>"+t.integral+'</div>                             <div class="shopNum">                                 <a href="javascript:void(0);" class="minus" goodsId=\''+t.goodsId+'\'>－</a>                                 <span class="num" >'+t.qty+'</span>                                 <a href="javascript:void(0);" class="plus" goodsId=\''+t.goodsId+"'>+</a>                             </div>                         </div>                     </div>                 </div></li>"}),o+="</ul>",o+="<div class='priceTotal'>合计积分：<span class='shop-total-amount ShopTotal'>0</span></div>"}),$(".shopping").html(o)}}}),$(".payBtn").on("click",function(){for(var e=$(".goodsCheck:checked"),o="",t=0;t<e.length;t++)o+=$(e[t]).val()+",";e.length>0&&(o=o.substring(0,o.length-1)),$.ajax({type:"POST",url:"http://sge.cn:9090/erp/api/createOrder",data:{userid:180129145541,goodsids:o},dataType:"json",success:function(e){200==e.code&&($.cookie("createOrderData",JSON.stringify(e.data)),window.location.href="orderSubmit.html")}})}),$(document).on("click",".deletedIcon",function(){$(".floating").show();var e=$(this).parents("li").attr("value");console.info(e),$(".delBtn").on("click",function(){console.info(e),$.ajax({type:"POST",url:"http://sge.cn:9090/erp/api/updateCartGoods",data:{userid:180129145541,goodsid:e,qty:0},dataType:"json",success:function(e){200==e.code&&(window.location.href=window.location.href)}})})})}),$(function(){function e(){var e=0;$(".shopGroup").each(function(){var o=0;$(this).find(".goodsCheck").each(function(){if($(this).is(":checked")){var e=parseInt($(this).parents(".shopCon").find(".num").text()),t=parseInt($(this).parents(".shopCon").find(".price").text());o+=t*e}$(this).closest(".shopGroup").find(".ShopTotal").text(o)});var t=parseInt($(this).find(".ShopTotal").text());e+=t}),$("#AllTotal").text(e)}$(document).on("click",".minus",function(){var o=$(this).parent().find(".num");console.info(o);var t=$(this).attr("goodsid"),c=parseInt(o.text())-1;o.text(c),o.text()<=1&&o.text(1),e(),updateCartGoods(t,c)}),$(document).on("click",".plus",function(){var o=$(this).parent().find(".num"),t=$(this).attr("goodsid"),c=parseInt(o.text())+1;o.text(c),o.text()<=1&&o.text(1),e(),updateCartGoods(t,c)}),$(document).on("click",".goodsCheck",function(){var o=$(this).closest(".shopGroup").find(".goodsCheck"),t=$(this).closest(".shopGroup").find(".goodsCheck:checked"),c=$(this).closest(".shopGroup").find(".shopCheck");o.length==t.length?(c.prop("checked",!0),$(".shopCheck").length==$(".shopCheck:checked").length?($("#AllCheck").prop("checked",!0),e()):($("#AllCheck").prop("checked",!1),e())):(c.prop("checked",!1),$("#AllCheck").prop("checked",!1),e())}),$(document).on("click",".shopCheck",function(){1==$(this).prop("checked")?($(this).parents(".shopGroup").find(".check").prop("checked",!0),$(".shopCheck").length==$(".shopCheck:checked").length?($("#AllCheck").prop("checked",!0),e()):($("#AllCheck").prop("checked",!1),e())):($(this).parents(".shopGroup").find(".check").prop("checked",!1),$("#AllCheck").prop("checked",!1),e())}),$(document).on("click","#allCheck",function(){1==$(this).prop("checked")?($(".check").prop("checked",!0),e()):($(".check").prop("checked",!1),e()),$(".shopCheck").change()})}),$(function(){var e=parseInt($("#orderPrice").text())*parseInt($("#orderNum").text());$(".orderTotal").text(e)});